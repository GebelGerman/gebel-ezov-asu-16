<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/authorization_registration.css">
    <title>Регистрация</title>    
</head>
<body>
    <header>
            <div class="container"> <!--Зона всего-->
                <div class="heading  clearfix">
                    <nav>
                        <ul class="heading_menu">
                            <li>
                                <a href="/" class="logotype">
                                   Bang-Bang!
                                </a>
                            </li>                           
                        </ul>                        
                    </nav>
                </div>              
            </div>
    </header>
    <section id="authorization_registration">
        <div class="container">
            <div class="authorization_registration_menu">
                <form method="POST" enctype="text/plan" id="form" action="/reg" >
                    <fieldset >
                        <h2>Регистрация</h2>
                        <p>Придумайте ник</p>
                        <input type="text" id="nickname" placeholder="например, marcelo">
                        <p>Электронная почта</p>
                        <input type="text" id="email" placeholder="например, b@ng.com">
                        <p>Пароль</p>
                        <input type="password" id="password" placeholder="например, ••••••••••">
                        <input type="button" id="button" value="OK" onclick="validReg(document.getElementById('form'))">
                    </fieldset>
                </form>
            </div>  
        </div>            
    </section>
    <script type='text/javascript'>
        function validReg(form){
            var fail;
            var error = false;
            var nickname = form.nickname.value;
            var email = form.email.value;
            var password = form.password.value;

            var checkEmail = /^[0-9a-z._-]+@[a-z]+\.[a-z]{2,5}/;

            if (nickname == "" || nickname == " "){
                fail = "Вы не ввели ник";
                error = true;
            } else if (!checkEmail.test(email)){
                fail = "Вы ввели email не правильно";
                error = true;
            } else if (password == "" || password == " "){
                fail = "Вы не ввели пароль";
                error = true;
            } 
            if (error) {
                alert(fail);
            } else {
                var xhr = new XMLHttpRequest();
                var json = JSON.stringify({
                    nickname: nickname,
                    email: email,
                    password: password
                });
                xhr.open("POST", '/reg', true);
                xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');

                xhr.send(json);
                window.location = '/auth'                
            }
        }        
    </script>
</body>
</html>
